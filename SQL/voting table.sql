CREATE TABLE VOTE(
    VOTE_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    REVIEW_ID NUMBER NULL REFERENCES REVIEWS(REVIEW_ID) ON DELETE CASCADE,
    COMMENT_ID NUMBER NULL REFERENCES COMMENTS(COMM_ID) ON DELETE CASCADE,
    UPVOTES NUMBER(10) DEFAULT 0 NOT NULL,
    DOWNVOTES NUMBER(10) DEFAULT 0 NOT NULL,
    CONSTRAINT check_target CHECK (
        (REVIEW_ID IS NOT NULL AND COMMENT_ID IS NULL)
        OR
        (REVIEW_ID IS NOT NULL AND COMMENT_ID IS NOT NULL)
        )
);

CREATE INDEX IDX_VOTE_REVIEWS ON VOTE(REVIEW_ID);
CREATE INDEX IDX_VOTE_COMMENTS ON VOTE(COMMENT_ID);


ALTER TABLE USERS
ADD is_admin NUMBER(1) DEFAULT 0 NOT NULL;